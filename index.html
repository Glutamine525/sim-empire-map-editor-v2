<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>模拟帝国布局图编辑器V2</title>
        <link rel="icon" href="./img/logo.png" />
        <link rel="stylesheet" href="./library/fontawesome.all.css" />
        <link rel="stylesheet" href="./library/element-ui.v2.14.1.css" />
        <script src="./library/jquery.v3.5.1.min.js"></script>
        <script src="./library/md5.v2.18.0.min.js"></script>
        <link rel="stylesheet" href="./style/color.css" />
        <link rel="stylesheet" href="./style/boundary.css" />
        <link rel="stylesheet" href="./style/loading-background.css" />
        <link rel="stylesheet" href="./style/minion.css" />
        <link rel="stylesheet" href="./style/ghost.css" />
        <link rel="stylesheet" href="./style/button.css" />
        <link rel="stylesheet" href="./style/switcher.css" />
        <link rel="stylesheet" href="./style/top-menu.css" />
        <link rel="stylesheet" href="./style/main.css" />
        <link rel="stylesheet" href="./style/side-nav.css" />
        <link rel="stylesheet" href="./style/top-nav.css" />
        <link rel="stylesheet" href="./style/content.css" />
        <link rel="stylesheet" href="./style/editor-panel.css" />
        <script src="./js/constant/label-text.js"></script>
        <script src="./js/constant/building-color.js"></script>
        <script src="./js/constant/building-fixed.js"></script>
        <script src="./js/constant/building-china.js"></script>
        <script src="./js/constant/building-persian.js"></script>
        <script src="./js/constant/building-egypt.js"></script>
        <script src="./js/constant/building-greece.js"></script>
        <script src="./js/constant/building-aztec.js"></script>
        <script src="./js/constant/light-mode.js"></script>
        <script src="./js/constant/dark-mode.js"></script>
        <script src="./js/util.js"></script>
        <script src="./js/config.js"></script>
        <script src="./js/mouse-event.js"></script>
        <script src="./js/keyboard-event.js"></script>
        <script src="./js/other-event.js"></script>
        <script src="./js/top-nav.js"></script>
        <script src="./js/side-nav.js"></script>
        <script src="./js/content.js"></script>
        <script src="./js/building.js"></script>
        <script src="./js/building-range.js"></script>
        <script src="./js/mini-map.js"></script>
        <script src="./js/block.js"></script>
        <script src="./js/selection-block.js"></script>
        <script src="./js/deletion-block.js"></script>
        <script src="./js/import-and-export.js"></script>
        <script src="./js/auto-save.js"></script>
    </head>
    <body>
        <script>
            console.time("loading");
        </script>
        <div id="app" style="display: none">
            <div id="top-nav">
                <div id="top-nav-controller">
                    <div id="top-nav-height-helper">
                        <svg
                            id="ham-button"
                            class="ham-button ham-button-rotate"
                            viewBox="0 0 100 100"
                            width="80"
                            style="margin-left: 10px"
                            onclick="onClickHamButton(this.className.baseVal.indexOf('active')>-1)"
                        >
                            <path
                                class="line top"
                                d="m 30,33 h 40 c 0,0 8.5,-0.68551 8.5,10.375 0,8.292653 -6.122707,9.002293 -8.5,6.625 l -11.071429,-11.071429"
                            />
                            <path class="line middle" d="m 70,50 h -40" />
                            <path
                                class="line bottom"
                                d="m 30,67 h 40 c 0,0 8.5,0.68551 8.5,-10.375 0,-8.292653 -6.122707,-9.002293 -8.5,-6.625 l -11.071429,11.071429"
                            />
                        </svg>
                        <div>
                            <div>地图类型:</div>
                            <ul class="top-menu">
                                <li class="top-menu-item">
                                    <a
                                        id="wood-num"
                                        style="color: var(--color-text-primary); font-weight: bold"
                                        onmouseover="$$$('#wood-num + ul li', true).forEach((node) => (node.style.display = 'block'))"
                                        >0</a
                                    >
                                    <ul class="top-sub-menu">
                                        <li class="top-menu-item-active">
                                            <a value="5" onclick="onClickWoodNum(this.getAttribute('value'))">5</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="4" onclick="onClickWoodNum(this.getAttribute('value'))">4</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="3" onclick="onClickWoodNum(this.getAttribute('value'))">3</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <div>文明:</div>
                            <ul class="top-menu">
                                <li class="top-menu-item">
                                    <a
                                        id="civil"
                                        style="color: var(--color-text-primary); font-weight: bold"
                                        onmouseover="$$$('#civil + ul li', true).forEach((node) => (node.style.display = 'block'))"
                                        >中国</a
                                    >
                                    <ul class="top-sub-menu">
                                        <li class="top-menu-item-active">
                                            <a value="中国" onclick="onClickCivil(this.getAttribute('value'))">中国</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="波斯" onclick="onClickCivil(this.getAttribute('value'))">波斯</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="埃及" onclick="onClickCivil(this.getAttribute('value'))">埃及</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="希腊" onclick="onClickCivil(this.getAttribute('value'))">希腊</a>
                                        </li>
                                        <li class="top-menu-item-active">
                                            <a value="阿兹特克" onclick="onClickCivil(this.getAttribute('value'))"
                                                >阿兹特克</a
                                            >
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <div>无木之地:</div>
                            <div class="toggle toggle--ordinary">
                                <input
                                    type="checkbox"
                                    id="toggle-no-wood"
                                    class="toggle--checkbox"
                                    onclick="onClickNoWood(this.checked)"
                                />
                                <label class="toggle--btn" for="toggle-no-wood"></label>
                            </div>
                        </div>
                        <div>
                            <div>显示模式:</div>
                            <div class="toggle toggle--daynight">
                                <input
                                    type="checkbox"
                                    id="toggle-display-mode"
                                    class="toggle--checkbox"
                                    checked="true"
                                    onclick="onClickDisplayMode(this.checked)"
                                />
                                <label class="toggle--btn" for="toggle-display-mode"
                                    ><span class="toggle--feature"></span
                                ></label>
                            </div>
                        </div>
                        <div>
                            <div>小地图:</div>
                            <div class="toggle toggle--ordinary">
                                <input
                                    type="checkbox"
                                    id="toggle-mini-map"
                                    class="toggle--checkbox"
                                    checked="true"
                                    onclick="onClickMiniMap(this.checked)"
                                />
                                <label class="toggle--btn" for="toggle-mini-map"></label>
                            </div>
                        </div>
                        <div>
                            <div>旋转地图:</div>
                            <div class="toggle toggle--ordinary">
                                <input
                                    type="checkbox"
                                    id="toggle-rotation"
                                    class="toggle--checkbox"
                                    onclick="onClickRotateMap(this.checked)"
                                />
                                <label class="toggle--btn" for="toggle-rotation"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="top-nav-operation">
                    <!-- <div>
                        选中:
                        <strong id="top-nav-selected">无</strong>
                    </div> -->
                    <div>
                        当前操作:
                        <strong id="top-nav-holding">无</strong>
                    </div>
                </div>
                <div id="top-nav-count">
                    <div>
                        <div>
                            普通住宅:
                            <strong id="top-nav-residence-0">0</strong>
                            个
                        </div>
                        <div>
                            高级住宅:
                            <strong id="top-nav-residence-1">0</strong>
                            个
                        </div>
                    </div>
                    <div style="margin-left: 10px">
                        <div>
                            粮仓:
                            <strong id="top-nav-warehouse-0">0</strong>
                            个
                        </div>
                        <div>
                            货栈:
                            <strong id="top-nav-warehouse-1">0</strong>
                            个
                        </div>
                    </div>
                </div>
                <el-tooltip id="top-nav-minion" popper-class="hint-popper" placement="bottom-start">
                    <div slot="content">
                        <div style="color: var(--color-text-primary)">
                            <strong>快捷键:</strong>
                        </div>
                        <div>- 空格: 取消操作</div>
                        <div>- A: 道路</div>
                        <div>- S: 选中建筑</div>
                        <div>- D: 删除建筑</div>
                        <div>- ZXC(V): 三(四)防建筑</div>
                        <div>- QWER: 2x2 3x3 4x4 5x5 通用建筑</div>
                        <div style="width: 100%; border: 1px solid var(--color-border-base); margin: 4px 0"></div>
                        <div style="color: var(--color-text-primary)">
                            <strong>其它操作:</strong>
                        </div>
                        <div>- 右键点击住宅建筑可以查询需求结果</div>
                        <div>- 查询需求结果里的建筑可以选中</div>
                        <div>- 双击建筑可以删除建筑</div>
                        <div>- 按住Ctrl键可以在选中操作时拖动地图</div>
                        <div>- 使用相同大小的建筑可以覆盖通用建筑</div>
                        <div>- 鼠标悬停在建筑上，按Ctrl+C可以复制建筑</div>
                        <div>- 如果无法放置建筑，尝试按一次Ctrl</div>
                        <div style="width: 100%; border: 1px solid var(--color-border-base); margin: 4px 0"></div>
                        <div style="color: var(--color-text-primary)">
                            <strong>注意事项:</strong>
                        </div>
                        <div>- 特殊建筑的数据会被导入导出</div>
                        <div>- 编辑者自定义的水印会被导入导出</div>
                        <div>- 菜单中「添加水印」里的截图才会生成编辑者水印</div>
                        <div>- 版权水印总是会生成</div>
                        <div>- 旋转地图开启后，无法编辑，只能截图</div>
                        <div style="width: 100%; border: 1px solid var(--color-border-base); margin: 4px 0"></div>
                        <div>
                            作者联系邮箱:
                            <strong
                                style="color: var(--color-text-primary); cursor: pointer"
                                onclick="onClickLink('glutamine525@gmail.com')"
                            >
                                glutamine525@gmail.com
                            </strong>
                        </div>
                    </div>
                    <div>
                        <div id="minion" class="face">
                            <div class="eyes">
                                <div class="eye"></div>
                                <div class="eye"></div>
                            </div>
                        </div>
                    </div>
                </el-tooltip>
                <div id="top-nav-info">
                    <div>
                        模拟帝国地图编辑器:
                        <strong id="top-nav-version"></strong>
                    </div>
                    <div>
                        作者:
                        <strong id="top-nav-author">咕噜他命</strong>
                        &emsp;网站搭建:
                        <strong id="top-nav-author">枫轻舞</strong>
                    </div>
                </div>
            </div>
            <div id="main-page">
                <div id="side-nav">
                    <div class="side-nav-container">
                        <el-menu :collapse="true" @select="onSelect">
                            <el-menu-item index="道路">
                                <img :src="'./img/道路.png'" />
                                <span slot="title">道路</span>
                            </el-menu-item>
                            <el-submenu
                                v-for="item1 in buildingCatagory"
                                :key="item1"
                                :index="item1"
                                :show-timeout="100"
                                :hide-timeout="100"
                                popper-class="popper"
                            >
                                <template slot="title">
                                    <img :src="'./img/' + item1 + '.png'" />
                                    <span slot="title">{{ item1 }}</span>
                                </template>
                                <el-menu-item-group :title="item1">
                                    <el-menu-item
                                        v-for="(item2, index) in buildingInfo[item1]"
                                        :key="item2.name"
                                        :index="item2.name"
                                    >
                                        {{ index+1 + ". " + item2.name }}
                                    </el-menu-item>
                                </el-menu-item-group>
                            </el-submenu>
                            <el-submenu index="特殊建筑" :show-timeout="100" :hide-timeout="100" popper-class="popper">
                                <template slot="title">
                                    <img :src="'./img/特殊建筑.png'" />
                                    <span slot="title">特殊建筑</span>
                                </template>
                                <el-menu-item-group title="特殊建筑">
                                    <el-menu-item
                                        v-for="(item, index) in specialBuildingList"
                                        :key="item.name"
                                        :index="item.name"
                                    >
                                        {{ index+1 + ". " + item.name }}
                                    </el-menu-item>
                                </el-menu-item-group>
                            </el-submenu>
                            <el-menu-item v-for="item1 in operationCatagory2" :key="item1" :index="item1">
                                <img :src="'./img/' + item1 + '.png'" />
                                <span slot="title">{{ item1 }}</span>
                            </el-menu-item>
                            <el-submenu
                                v-for="item1 in operationCatagory1"
                                :key="item1"
                                :index="item1"
                                :show-timeout="100"
                                :hide-timeout="100"
                                popper-class="popper"
                            >
                                <template slot="title">
                                    <img :src="'./img/' + item1 + '.png'" />
                                    <span slot="title">{{ item1 }}</span>
                                </template>
                                <el-menu-item-group :title="item1">
                                    <el-menu-item
                                        v-for="(item2, index) in labelText[item1]"
                                        :key="item2"
                                        :index="item2"
                                    >
                                        {{ index+1 + ". " + item2 }}
                                    </el-menu-item>
                                </el-menu-item-group>
                            </el-submenu>
                        </el-menu>
                    </div>
                </div>
                <div id="content">
                    <div id="map">
                        <canvas id="cell" width="3480" height="3480"></canvas>
                        <div id="building"></div>
                        <div id="sign">
                            <div id="author-sign">
                                <div style="font-size: 100px">
                                    <span id="sign-civil" class="highlight" style="color: var(--color-primary)"></span>
                                    <span> </span>
                                    <span
                                        id="sign-wood-num"
                                        class="highlight"
                                        style="color: var(--color-danger)"
                                    ></span>
                                    <span id="sign-is-no-wood" class="highlight" style="color: var(--color-success)">
                                        有木
                                    </span>
                                    <span> 地图布局</span>
                                </div>
                                <div>
                                    <span>From the Map Editor </span>
                                    <span id="sign-version" class="highlight"></span>
                                    <span> Implemented by </span>
                                    <span class="highlight">Glutamine525</span>
                                </div>
                                <div>
                                    <span>网页链接: </span>
                                    <span
                                        class="highlight link"
                                        onclick="onClickLink('http://home.fengqingwu.top/simempiremap')"
                                    >
                                        http://home.fengqingwu.top/simempiremap
                                    </span>
                                    <span>Powered by</span>
                                    <span class="highlight">枫轻舞</span>
                                </div>
                                <div>
                                    <span>Github: </span>
                                    <a
                                        class="highlight link"
                                        onclick="onClickLink('https://github.com/Glutamine525/sim-empire-map-editor-v2')"
                                    >
                                        https://github.com/Glutamine525/sim-empire-map-editor-v2
                                    </a>
                                </div>
                                <div>
                                    <span>Email: </span>
                                    <span class="highlight link" onclick="onClickLink('glutamine525@gmail.com')">
                                        glutamine525@gmail.com
                                    </span>
                                </div>
                            </div>
                            <div id="user-sign" style="display: none">
                                <div
                                    v-for="(sign, i) in userSign"
                                    :key="'sign-'+i"
                                    :style="{ 
                                        textAlign: sign.textAlign,
                                        top: sign.top+'px',
                                        left: sign.left+'px',
                                        transform: 'rotate('+sign.rotateDegree+'deg)',
                                    }"
                                >
                                    <div
                                        v-for="(line, j) in userSign[i].lines"
                                        :style="{ 
                                            fontSize: line.fontSize+'px',
                                            opacity: line.opacity,
                                        }"
                                    >
                                        <span
                                            v-for="(element, k) in userSign[i].lines[j].elements"
                                            :class="{ highlight: element.isHighlight }"
                                            :style="{ 
                                                color: element.color,
                                                textShadow: element.shadowColor == null ? 'none' : '0 0 ' + element.shadowSize+'px' + ' ' + element.shadowColor,
                                            }"
                                        >
                                            {{ element.text }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="map-function">
                        <div id="preview" class="building">
                            <div id="preview-text" class="text"></div>
                            <div id="preview-marker" class="marker"></div>
                        </div>
                        <div id="road-helper"></div>
                        <div id="range-container"></div>
                        <div id="selection-block"></div>
                        <div id="deletion-block"></div>
                        <div id="selection-operation">
                            <div
                                id="selection-operation-left"
                                onclick="onClickBlockMove('left', 3)"
                                class="iconbtn fas fa-arrow-left"
                            ></div>
                            <div
                                id="selection-operation-right"
                                onclick="onClickBlockMove('right', 1)"
                                class="iconbtn fas fa-arrow-right"
                            ></div>
                            <div
                                id="selection-operation-bottom"
                                onclick="onClickBlockMove('bottom', 2)"
                                class="iconbtn fas fa-arrow-down"
                            ></div>
                            <div
                                id="selection-operation-top"
                                onclick="onClickBlockMove('top', 0)"
                                class="iconbtn fas fa-arrow-up"
                            ></div>
                        </div>
                        <div id="deletion-operation">
                            <div
                                id="deletion-operation-button"
                                onclick="onClickBlockDelete()"
                                class="iconbtn far fa-trash-alt"
                            ></div>
                        </div>
                        <div
                            id="mini-map-container"
                            onclick="onMiniMapMouseClick(event)"
                            onmousemove="onMiniMapMouseMove(event)"
                        >
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                            <div id="mini-map-border">
                                <canvas id="mini-map" width="232" height="232"></canvas>
                            </div>
                            <div id="mini-map-focus"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="editor-container">
                <div id="editor">
                    <el-tabs id="editor-tab" v-model="editorPanelTab">
                        <el-tab-pane id="auto-save" label="自动保存" name="first">
                            <el-table :data="autoSave">
                                <el-table-column prop="woodNum" label="地图类型" align="center"> </el-table-column>
                                <el-table-column prop="civil" label="文明" align="center"> </el-table-column>
                                <el-table-column prop="isNoWood" label="无木之地" align="center">
                                    <template slot-scope="scope">
                                        <span
                                            :style="{ color: scope.row.isNoWood ? 'var(--color-success)' : 'var(--color-danger)' }"
                                        >
                                            {{ scope.row.isNoWood ? '√' : '×' }}
                                        </span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="isLightMode" label="显示模式" align="center">
                                    <template slot-scope="scope">
                                        {{ scope.row.isLightMode ? '亮色' : '暗色' }}
                                    </template>
                                </el-table-column>
                                <el-table-column prop="showMiniMap" label="小地图" align="center">
                                    <template slot-scope="scope">
                                        <span
                                            :style="{ color: scope.row.showMiniMap ? 'var(--color-success)' : 'var(--color-danger)' }"
                                        >
                                            {{ scope.row.showMiniMap ? '√' : '×' }}
                                        </span>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="buildings.length" label="建筑总数" align="center">
                                </el-table-column>
                                <el-table-column prop="roads.length" label="道路总数" align="center"> </el-table-column>
                                <el-table-column prop="timestamp" label="存档时间" align="center" width="150">
                                    <template slot-scope="scope"> {{ formatTimestamp(scope.row.timestamp) }} </template>
                                </el-table-column>
                                <el-table-column label="操作" align="center" width="150">
                                    <template slot-scope="scope">
                                        <el-button size="mini" @click="handleEdit(scope.$index, scope.row)">
                                            预览
                                        </el-button>
                                        <el-button
                                            size="mini"
                                            type="primary"
                                            @click="loadAutoSave(scope.$index, scope.row)"
                                        >
                                            载入
                                        </el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                        </el-tab-pane>
                        <el-tab-pane id="special-building" label="特殊建筑" name="second">
                            <div id="special-building-preview">
                                <div class="preview-box">
                                    <div class="preview-box-sheet">
                                        <div v-for="i in previewBox.row" :key="'previewBox-'+i" class="preview-box-row">
                                            <div
                                                v-for="j in previewBox.cell"
                                                :key="'previewBox-'+i+'-'+j"
                                                class="preview"
                                                :style="{ 
                                                    width: `${specialBuilding.width * 30}px`, 
                                                    height: `${specialBuilding.height * 30}px`,
                                                    color: specialBuilding.color,
                                                    background: specialBuilding.background,
                                                    borderColor: specialBuilding.borderColor,
                                                    borderWidth: `${specialBuilding.borderWidth}px`,
                                                    fontSize: `${specialBuilding.fontSize}px`
                                                }"
                                            >
                                                <div class="text" v-html="specialBuilding.text"></div>
                                                <div
                                                    class="marker"
                                                    :style="{ 
                                                        color: previewMarkerColor, 
                                                        display: specialBuilding.isDecoration || specialBuilding.isMiracle ? 'none' : 'block'
                                                    }"
                                                >
                                                    0
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="preview-operation">
                                    <div>
                                        <el-button size="small" type="info" round @click="onClickPreviewSingle">
                                            单个
                                        </el-button>
                                        <el-button size="small" type="info" round @click="onClickPreviewRow">
                                            横向
                                        </el-button>
                                        <el-button size="small" type="info" round @click="onClickPreviewColumn">
                                            纵向
                                        </el-button>
                                        <el-button size="small" type="info" round @click="onClickPreviewOverspread">
                                            平铺
                                        </el-button>
                                    </div>
                                    <div style="margin-top: 16px">
                                        <el-button size="small" type="danger" round @click="previewMarkerColor='red'"
                                            >防护未满</el-button
                                        >
                                        <el-button size="small" type="success" round @click="previewMarkerColor='green'"
                                            >防护已满</el-button
                                        >
                                    </div>
                                </div>
                            </div>
                            <div id="special-building-setting">
                                <div class="setting-row center" style="margin: 0 0 10px 0">
                                    已添加
                                    <span style="color: var(--color-text-primary); font-weight: bold; margin: 0 4px">
                                        {{ specialBuildingList.length }}
                                    </span>
                                    个特殊建筑，最多添加10个。
                                </div>
                                <div class="setting-row center" style="margin: 0 0 20px 0">
                                    <el-tooltip
                                        v-for="(item, index) in specialBuildingList"
                                        :key="'special-'+item.name"
                                        popper-class="hint-popper"
                                        effect="dark"
                                        placement="bottom"
                                    >
                                        <div
                                            slot="content"
                                            class="building-hint"
                                            style="grid-template-rows: repeat(7, 1fr)"
                                        >
                                            <div class="building-hint-row div1">
                                                建筑名称:
                                                <span style="font-weight: bold">{{ item.name }}</span>
                                            </div>
                                            <div class="building-hint-row div2">
                                                显示文字:
                                                <span style="font-weight: bold">{{ item.text }}</span>
                                            </div>
                                            <span class="building-hint-cell div3">
                                                宽度:
                                                <span style="font-weight: bold">{{ item.width }}</span>
                                                格
                                            </span>
                                            <span class="building-hint-cell div4">
                                                高度:
                                                <span style="font-weight: bold"> {{ item.height }} </span>
                                                格
                                            </span>
                                            <span class="building-hint-cell div5">
                                                文字颜色:
                                                <span
                                                    :style="{ color: item.color, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                >
                                                    {{ item.color }}
                                                </span>
                                            </span>
                                            <span class="building-hint-cell div6">
                                                字体大小:
                                                <span style="font-weight: bold">{{ item.fontSize }}</span>
                                                px
                                            </span>
                                            <span class="building-hint-cell div7">
                                                边框颜色:
                                                <span
                                                    :style="{ color: item.borderColor, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                >
                                                    {{ item.borderColor }}
                                                </span>
                                            </span>
                                            <span class="building-hint-cell div8">
                                                边框宽度:
                                                <span style="font-weight: bold">{{ item.borderWidth }}</span>
                                                px
                                            </span>
                                            <span class="building-hint-cell div9">
                                                背景颜色:
                                                <span
                                                    :style="{ color: item.background, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                >
                                                    {{ item.background }}
                                                </span>
                                            </span>
                                            <span class="building-hint-cell div10">
                                                影响范围:
                                                <span style="font-weight: bold">{{ item.range }}</span>
                                                格
                                            </span>
                                            <span class="building-hint-cell div11">
                                                美化建筑:
                                                <span
                                                    :style="{ color: item.isDecoration ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                >
                                                    {{ item.isDecoration ? '√' : '×' }}
                                                </span>
                                            </span>
                                            <span class="building-hint-cell div12">
                                                奇迹建筑:
                                                <span
                                                    :style="{ color: item.isMiracle ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                >
                                                    {{ item.isMiracle? '√' : '×' }}
                                                </span>
                                            </span>
                                        </div>
                                        <el-tag
                                            size="medium"
                                            closable
                                            style="margin: 10px"
                                            effect="dark"
                                            @close="deleteSpecialBuilding(index)"
                                        >
                                            {{ item.name }}
                                        </el-tag>
                                    </el-tooltip>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>建筑名称: </label>
                                        <el-input v-model="specialBuilding.name" style="width: 180px"></el-input>
                                    </div>
                                    <div class="setting-cell">
                                        <el-tooltip
                                            popper-class="hint-popper"
                                            effect="dark"
                                            content="输入<br />即可换行"
                                            placement="bottom"
                                        >
                                            <label>显示文字: </label>
                                        </el-tooltip>
                                        <el-input v-model="specialBuilding.text" style="width: 180px"></el-input>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>建筑宽度: </label>
                                        <el-input-number v-model="specialBuilding.width" :min="1"></el-input-number>
                                    </div>
                                    <div class="setting-cell">
                                        <label>建筑高度: </label>
                                        <el-input-number v-model="specialBuilding.height" :min="1"></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>文字颜色: </label>
                                        <el-color-picker v-model="specialBuilding.color"></el-color-picker>
                                    </div>
                                    <div class="setting-cell">
                                        <label>字体大小: </label>
                                        <el-input-number
                                            v-model="specialBuilding.fontSize"
                                            :min="12"
                                            :max="48"
                                        ></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>边框颜色: </label>
                                        <el-color-picker v-model="specialBuilding.borderColor"></el-color-picker>
                                    </div>
                                    <div class="setting-cell">
                                        <label>边框宽度: </label>
                                        <el-input-number
                                            v-model="specialBuilding.borderWidth"
                                            :min="1"
                                            :max="10"
                                        ></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>背景颜色: </label>
                                        <el-color-picker v-model="specialBuilding.background"></el-color-picker>
                                    </div>
                                    <div class="setting-cell">
                                        <label>影响范围: </label>
                                        <el-input-number v-model="specialBuilding.range" :min="0"></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>美化建筑: </label>
                                        <el-switch v-model="specialBuilding.isDecoration"></el-switch>
                                    </div>
                                    <div class="setting-cell">
                                        <label>奇迹建筑: </label>
                                        <el-switch v-model="specialBuilding.isMiracle"></el-switch>
                                    </div>
                                </div>
                                <div class="setting-row" style="margin: 80px 0 0 0; justify-content: center">
                                    <el-button type="primary" round @click="onClickInsertSpecialBuilding">
                                        添加
                                    </el-button>
                                </div>
                            </div>
                        </el-tab-pane>
                        <el-tab-pane id="user-sign-editor" label="添加水印" name="third">
                            <div id="user-sign-preview">
                                <div class="preview-box">
                                    <canvas
                                        id="user-sign-map-preview"
                                        width="232"
                                        height="232"
                                        style="width: 100%; height: 100%"
                                    ></canvas>
                                </div>
                                <div class="preview-operation">
                                    <div>
                                        <el-button
                                            type="info"
                                            size="small"
                                            round
                                            onclick="$$('toggle-display-mode').checked=true,onClickDisplayMode(true)"
                                        >
                                            亮色
                                        </el-button>
                                        <el-button
                                            type="info"
                                            size="small"
                                            round
                                            onclick="$$('toggle-display-mode').checked=false,onClickDisplayMode(false)"
                                        >
                                            暗色
                                        </el-button>
                                        <el-button
                                            type="warning"
                                            size="small"
                                            round
                                            onclick="$$('toggle-rotation').checked=!$config.isMapRotated,onClickRotateMap(!$config.isMapRotated)"
                                        >
                                            旋转
                                        </el-button>
                                        <el-button type="primary" size="small" round onclick="screenshot(true)">
                                            截图
                                        </el-button>
                                    </div>
                                </div>
                            </div>
                            <div id="user-sign-setting">
                                <div class="setting-row">
                                    <span style="margin-right: 10px">水印:</span>
                                    <el-button
                                        size="mini"
                                        type="primary"
                                        round
                                        style="margin-right: 10px"
                                        @click="insertUserSign"
                                    >
                                        添加
                                    </el-button>
                                    <el-radio-group
                                        v-model="radioLabelUserSign"
                                        size="mini"
                                        @change="onChangeRadioUserSign"
                                    >
                                        <el-radio-button
                                            v-for="item in userSign"
                                            :key="'radio-sign-'+item.name"
                                            :label="item.name"
                                        ></el-radio-button>
                                    </el-radio-group>
                                </div>
                                <div class="setting-row" style="margin-top: 0">
                                    <span style="margin-right: 10px">&emsp;行:</span>
                                    <el-button
                                        size="mini"
                                        type="primary"
                                        round
                                        style="margin-right: 10px"
                                        @click="insertUserSignLine"
                                    >
                                        添加
                                    </el-button>
                                    <el-radio-group
                                        v-model="radioLabelUserSignLine"
                                        size="mini"
                                        @change="onChangeRadioUserSignLine"
                                    >
                                        <el-radio-button
                                            v-for="(item, index) in userSign[radioIndexUserSign].lines"
                                            :key="'radio-sign-line-'+index"
                                            :label="'第'+(index+1)+'行'"
                                        ></el-radio-button>
                                    </el-radio-group>
                                </div>
                                <div class="setting-row" style="margin-top: 0">
                                    <span style="margin-right: 10px">元素:</span>
                                    <el-button
                                        size="mini"
                                        type="primary"
                                        round
                                        style="margin-right: 10px"
                                        @click="insertUserSignElement"
                                    >
                                        添加
                                    </el-button>
                                    <el-radio-group
                                        v-model="radioLabelUserSignElement"
                                        size="mini"
                                        @change="radioIndexUserSignElement = +radioLabelUserSignElement.substring(1,radioLabelUserSignElement.length-1) - 1"
                                    >
                                        <el-radio-button
                                            v-for="(item, index) in userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements"
                                            :key="'radio-sign-element-'+index"
                                            :label="'第'+(index+1)+'个'"
                                        ></el-radio-button>
                                    </el-radio-group>
                                </div>
                                <div class="setting-row splitter"></div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>水印名称: </label>
                                        <span style="color: var(--color-text-primary); font-weight: bold">
                                            {{ userSign[radioIndexUserSign].name }}
                                        </span>
                                        <el-button
                                            size="mini"
                                            type="warning"
                                            round
                                            style="margin-left: 10px"
                                            @click="updateUserSign"
                                        >
                                            修改
                                        </el-button>
                                        <el-button
                                            size="mini"
                                            type="danger"
                                            round
                                            style="margin-left: 10px"
                                            @click="deleteUserSign"
                                        >
                                            删除
                                        </el-button>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>旋转角度: </label>
                                        <el-input-number
                                            v-model="userSign[radioIndexUserSign].rotateDegree"
                                            size="small"
                                            :min="-180"
                                            :max="180"
                                            :step="1"
                                        ></el-input-number>
                                    </div>
                                    <div class="setting-cell">
                                        <label>对齐样式: </label>
                                        <el-radio-group v-model="userSign[radioIndexUserSign].textAlign" size="small">
                                            <el-radio-button label="left" style="width: 64px">左对齐</el-radio-button>
                                            <el-radio-button label="right" style="width: 64px">右对齐</el-radio-button>
                                        </el-radio-group>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>上侧边距: </label>
                                        <el-input-number
                                            v-model="userSign[radioIndexUserSign].top"
                                            size="small"
                                            :min="0"
                                            :max="3480"
                                            :step="30"
                                            @blur="onChangeSignTop"
                                        ></el-input-number>
                                    </div>
                                    <div class="setting-cell">
                                        <label>左侧边距: </label>
                                        <el-input-number
                                            v-model="userSign[radioIndexUserSign].left"
                                            size="small"
                                            :min="0"
                                            :max="3480"
                                            :step="30"
                                            @blur="onChangeSignLeft"
                                        ></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row splitter"></div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>{{ radioLabelUserSignLine }}</label>
                                        <el-button
                                            size="mini"
                                            type="danger"
                                            round
                                            style="margin-left: 10px"
                                            @click="deleteUserSignLine"
                                        >
                                            删除
                                        </el-button>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>字体大小: </label>
                                        <el-input-number
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].fontSize"
                                            size="small"
                                            :min="30"
                                            :max="200"
                                            :step="10"
                                            @blur="onChangeSignFontSize"
                                        ></el-input-number>
                                    </div>
                                    <div class="setting-cell">
                                        <label>透&ensp;明&ensp;度: </label>
                                        <el-input-number
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].opacity"
                                            size="small"
                                            :min="0"
                                            :max="1"
                                            :step="0.05"
                                        ></el-input-number>
                                    </div>
                                </div>
                                <div class="setting-row splitter"></div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>{{ radioLabelUserSignElement }}元素</label>
                                        <el-button
                                            size="mini"
                                            type="danger"
                                            round
                                            style="margin-left: 10px"
                                            @click="deleteUserSignElement"
                                        >
                                            删除
                                        </el-button>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>字体加粗: </label>
                                        <el-switch
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements[radioIndexUserSignElement].isHighlight"
                                        ></el-switch>
                                    </div>
                                    <div class="setting-cell">
                                        <label>字体颜色: </label>
                                        <el-color-picker
                                            size="small"
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements[radioIndexUserSignElement].color"
                                        ></el-color-picker>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <div class="setting-cell">
                                        <label>阴影大小: </label>
                                        <el-input-number
                                            size="small"
                                            :min="0"
                                            :max="60"
                                            :step="1"
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements[radioIndexUserSignElement].shadowSize"
                                        ></el-input-number>
                                    </div>
                                    <div class="setting-cell">
                                        <label>阴影颜色: </label>
                                        <el-color-picker
                                            size="small"
                                            v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements[radioIndexUserSignElement].shadowColor"
                                        ></el-color-picker>
                                    </div>
                                </div>
                                <div class="setting-row">
                                    <label style="margin-right: 10px">显示文字: </label>
                                    <el-input
                                        v-model="userSign[radioIndexUserSign].lines[radioIndexUserSignLine].elements[radioIndexUserSignElement].text"
                                        style="width: calc(50% + 130px)"
                                        size="small"
                                    ></el-input>
                                </div>
                                <div class="setting-row" style="margin: 0"></div>
                            </div>
                        </el-tab-pane>
                        <el-tab-pane id="civil-editor" label="生成文明" name="forth">
                            <div id="civil-editor-step">
                                <div style="height: 100%">
                                    <el-steps
                                        direction="vertical"
                                        :active="civilEditorActiveStep"
                                        finish-status="success"
                                    >
                                        <el-step
                                            v-for="item in civilEditorStepLabel"
                                            :title="item"
                                            :key="item"
                                        ></el-step>
                                    </el-steps>
                                </div>
                            </div>
                            <div id="civil-editor-preview">
                                <div class="preview-box">
                                    <div
                                        class="preview"
                                        :style="{ 
                                            width: `${civilEditorPreview.width * 30}px`, 
                                            height: `${civilEditorPreview.height * 30}px`,
                                            color: civilEditorPreview.color,
                                            background: civilEditorPreview.backgroundColor,
                                            borderColor: civilEditorPreview.borderColor,
                                            borderWidth: `${civilEditorPreview.borderWidth}px`,
                                            fontSize: `${civilEditorPreview.fontSize}px`
                                        }"
                                        v-show="(civilEditorActiveStep<=9 && civilEditorResult[civilEditorStepLabel[civilEditorActiveStep]].length)
                                            || (civilEditorActiveStep===11)"
                                    >
                                        <div class="text">{{ civilEditorPreview.text }}</div>
                                        <div
                                            class="marker"
                                            v-show="!(civilEditorPreview.isDecoration||civilEditorPreview.isMiracle||civilEditorPreview.isProtection)"
                                        >
                                            0
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="civil-editor-setting">
                                <el-scrollbar>
                                    <div
                                        class="setting-row center"
                                        style="margin: 0 0 10px 0; font-size: 20px; font-weight: bold"
                                    >
                                        {{ civilEditorStepLabel[civilEditorActiveStep] }}
                                        <el-button
                                            type="primary"
                                            size="small"
                                            style="margin-left: 20px"
                                            round
                                            @click="insertCivilBuilding"
                                            v-show="civilEditorActiveStep<=9"
                                        >
                                            添加建筑
                                        </el-button>
                                    </div>
                                    <div
                                        class="setting-row center"
                                        style="margin: 0 0 10px 0"
                                        v-show="civilEditorActiveStep<=9"
                                    >
                                        <el-tooltip
                                            v-for="(item, index) in civilEditorResult[civilEditorStepLabel[civilEditorActiveStep]]"
                                            :key="'civil-editor-'+item.name"
                                            popper-class="hint-popper"
                                            effect="dark"
                                            placement="bottom"
                                        >
                                            <div slot="content" class="building-hint">
                                                <div class="building-hint-row div1">
                                                    建筑名称:
                                                    <span style="font-weight: bold">{{ item.name }}</span>
                                                </div>
                                                <div class="building-hint-row div2">
                                                    显示文字:
                                                    <span style="font-weight: bold">{{ item.text }}</span>
                                                </div>
                                                <span class="building-hint-cell div3">
                                                    宽度:
                                                    <span style="font-weight: bold">{{ item.width }}</span>
                                                    格
                                                </span>
                                                <span class="building-hint-cell div4">
                                                    高度:
                                                    <span style="font-weight: bold"> {{ item.height }} </span>
                                                    格
                                                </span>
                                                <span class="building-hint-cell div5">
                                                    文字颜色:
                                                    <span
                                                        :style="{ color: item.color, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.color }}
                                                    </span>
                                                </span>
                                                <span class="building-hint-cell div6">
                                                    字体大小:
                                                    <span style="font-weight: bold">16</span>
                                                    px
                                                </span>
                                                <span class="building-hint-cell div7">
                                                    边框颜色:
                                                    <span
                                                        :style="{ color: item.borderColor, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.borderColor }}
                                                    </span>
                                                </span>
                                                <span class="building-hint-cell div8">
                                                    边框宽度:
                                                    <span style="font-weight: bold">1</span>
                                                    px
                                                </span>
                                                <span class="building-hint-cell div9">
                                                    背景颜色:
                                                    <span
                                                        :style="{ color: item.backgroundColor, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.backgroundColor }}
                                                    </span>
                                                </span>
                                                <span class="building-hint-cell div10">
                                                    影响范围:
                                                    <span style="font-weight: bold">{{ item.range }}</span>
                                                    格
                                                </span>
                                                <span class="building-hint-cell div11">
                                                    美化建筑:
                                                    <span
                                                        :style="{ color: item.isDecoration ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.isDecoration ? '√' : '×' }}
                                                    </span>
                                                </span>
                                                <span class="building-hint-cell div12">
                                                    奇迹建筑:
                                                    <span
                                                        :style="{ color: item.isMiracle ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.isMiracle? '√' : '×' }}
                                                    </span>
                                                </span>
                                                <span class="building-hint-cell div13">
                                                    防护建筑:
                                                    <span
                                                        :style="{ color: item.isProtection ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                    >
                                                        {{ item.isProtection? '√' : '×' }}
                                                    </span>
                                                </span>
                                            </div>
                                            <el-tag
                                                size="medium"
                                                closable
                                                style="margin: 10px; cursor: pointer"
                                                :effect="item.effect"
                                                @click="selectCivilTag(index)"
                                                @close="deleteCivilTag(index)"
                                            >
                                                {{ (index+1) + ". " + item.name }}
                                            </el-tag>
                                        </el-tooltip>
                                    </div>
                                    <div v-show="civilEditorActiveStep<=9">
                                        <div class="setting-row">
                                            <div class="setting-cell">
                                                <label>建筑名称:</label>
                                                <span
                                                    style="color: var(--color-text-primary); font-weight: bold"
                                                    v-show="[0,1,2,3,4,5,6,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.name }}
                                                </span>
                                                <el-input
                                                    v-model="civilEditorPreview.name"
                                                    style="width: 180px"
                                                    v-show="[].indexOf(civilEditorActiveStep)>-1"
                                                ></el-input>
                                            </div>
                                            <div class="setting-cell">
                                                <label>显示名称:</label>
                                                <span
                                                    style="color: var(--color-text-primary); font-weight: bold"
                                                    v-show="[].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.text }}
                                                </span>
                                                <el-input
                                                    v-model="civilEditorPreview.text"
                                                    style="width: 180px"
                                                    v-show="[0,1,2,3,4,5,6,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                ></el-input>
                                            </div>
                                        </div>
                                        <div class="setting-row">
                                            <div class="setting-cell">
                                                <label>建筑宽度:</label>
                                                <span
                                                    style="color: var(--color-text-primary); font-weight: bold"
                                                    v-show="[].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.width }}格
                                                </span>
                                                <el-input-number
                                                    v-model="civilEditorPreview.width"
                                                    :min="1"
                                                    :max="20"
                                                    v-show="[0,1,2,3,4,5,6,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                ></el-input-number>
                                            </div>
                                            <div class="setting-cell">
                                                <label>建筑高度:</label>
                                                <span
                                                    style="color: var(--color-text-primary); font-weight: bold"
                                                    v-show="[].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.height }}格
                                                </span>
                                                <el-input-number
                                                    v-model="civilEditorPreview.height"
                                                    :min="1"
                                                    :max="20"
                                                    v-show="[0,1,2,3,4,5,6,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                ></el-input-number>
                                            </div>
                                        </div>
                                        <div class="setting-row">
                                            <div class="setting-cell">
                                                <label>影响范围:</label>
                                                <span
                                                    style="color: var(--color-text-primary); font-weight: bold"
                                                    v-show="[0,1,2,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.range }}格
                                                </span>
                                                <el-input-number
                                                    v-model="civilEditorPreview.range"
                                                    :min="0"
                                                    v-show="[3,4,5,6].indexOf(civilEditorActiveStep)>-1"
                                                ></el-input-number>
                                            </div>
                                            <div class="setting-cell">
                                                <label>文字颜色:</label>
                                                <span
                                                    :style="{
                                                        color: civilEditorPreview.color,
                                                        textShadow: 'var(--color-border-base) 0px 1px 10px',
                                                        fontWeight: 'bold',
                                                    }"
                                                    v-show="[0,1,2,3,5,6,7,9].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.color }}
                                                </span>
                                                <el-color-picker
                                                    v-model="civilEditorPreview.color"
                                                    :predefine="predefineColors"
                                                    v-show="[4,8].indexOf(civilEditorActiveStep)>-1"
                                                ></el-color-picker>
                                            </div>
                                        </div>
                                        <div class="setting-row">
                                            <div class="setting-cell">
                                                <el-tooltip popper-class="hint-popper" effect="dark" placement="bottom">
                                                    <div slot="content">
                                                        <div>为保证和其它文明建筑颜色风格一致，</div>
                                                        <div>
                                                            推荐使用下列预设来设置<strong>市政</strong>和<strong>美化</strong>建筑!
                                                        </div>
                                                        <br />
                                                        <div><strong>市政</strong></div>
                                                        <div>
                                                            水井:
                                                            <strong
                                                                style="
                                                                    color: #1f8fff;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #1F8FFF
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            防护建筑:
                                                            <strong
                                                                style="
                                                                    color: #ff3838;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #FF3838
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            粮仓:
                                                            <strong
                                                                style="
                                                                    color: #25ccf7;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #25CCF7
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            货栈:
                                                            <strong
                                                                style="
                                                                    color: #25eff7;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #25EFF7
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            宫殿或皇宫:
                                                            <strong
                                                                style="
                                                                    color: #fff200;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #FFF200
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            职务建筑(如 中国的衙门, 波斯的办公厅):
                                                            <strong
                                                                style="
                                                                    color: #ff7979;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #FF7979
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            贸易战:
                                                            <strong
                                                                style="
                                                                    color: #5a7ca3;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #5A7CA3
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            税务局:
                                                            <strong
                                                                style="
                                                                    color: #ff5e57;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #FF5E57
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            磨坊:
                                                            <strong
                                                                style="
                                                                    color: #b8e994;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #B8E994
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            浇灌渠、水车房:
                                                            <strong
                                                                style="
                                                                    color: #78e08f;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #78E08F
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            驿站:
                                                            <strong
                                                                style="
                                                                    color: #98aec7;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #98AEC7
                                                            </strong>
                                                        </div>
                                                        <br />
                                                        <div><strong>美化</strong></div>
                                                        <div>
                                                            树:
                                                            <strong
                                                                style="
                                                                    color: #32ff7e;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #32FF7E
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            城墙:
                                                            <strong
                                                                style="
                                                                    color: #3c6382;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #3C6382
                                                            </strong>
                                                        </div>
                                                        <div>
                                                            城门:
                                                            <strong
                                                                style="
                                                                    color: #0a3d62;
                                                                    text-shadow: var(--color-border-base) 0px 1px 10px;
                                                                "
                                                            >
                                                                #0A3D62
                                                            </strong>
                                                        </div>
                                                    </div>
                                                    <label>背景颜色:</label>
                                                </el-tooltip>
                                                <span
                                                    :style="{
                                                        color: civilEditorPreview.backgroundColor,
                                                        textShadow: 'var(--color-border-base) 0px 1px 10px',
                                                        fontWeight: 'bold',
                                                    }"
                                                    v-show="[0,1,2,3,5,6,7,9].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.backgroundColor }}
                                                </span>
                                                <el-color-picker
                                                    v-model="civilEditorPreview.backgroundColor"
                                                    :predefine="predefineBackgroundColors"
                                                    v-show="[4,8].indexOf(civilEditorActiveStep)>-1"
                                                ></el-color-picker>
                                            </div>
                                            <div class="setting-cell">
                                                <label>边框颜色:</label>
                                                <span
                                                    :style="{
                                                        color: civilEditorPreview.borderColor,
                                                        textShadow: 'var(--color-border-base) 0px 1px 10px',
                                                        fontWeight: 'bold',
                                                    }"
                                                    v-show="[0,1,2,3,4,5,6,7,8,9].indexOf(civilEditorActiveStep)>-1"
                                                >
                                                    {{ civilEditorPreview.borderColor }}
                                                </span>
                                                <el-color-picker
                                                    v-model="civilEditorPreview.borderColor"
                                                    v-show="[].indexOf(civilEditorActiveStep)>-1"
                                                ></el-color-picker>
                                            </div>
                                        </div>
                                        <div class="setting-row" v-show="civilEditorActiveStep===4">
                                            <div class="setting-cell">
                                                <label>防护建筑:</label>
                                                <el-switch v-model="civilEditorPreview.isProtection"></el-switch>
                                            </div>
                                        </div>
                                    </div>
                                    <div v-show="civilEditorActiveStep===10" style="margin: 20px 0">
                                        <div
                                            class="setting-row center"
                                            v-for="(item, index) in civilEditorResult['住宅']"
                                            :key="'transfer-'+index"
                                        >
                                            <el-transfer
                                                v-model="civilEditorResicenceReq[index]"
                                                :props="{
                                                    key: 'id',
                                                    label: 'id'
                                                }"
                                                :data="civilEditorResicenceData"
                                                :titles="[item.name,item.name+'需求']"
                                                filterable
                                            >
                                            </el-transfer>
                                        </div>
                                    </div>
                                    <div v-show="civilEditorActiveStep===11">
                                        <div class="setting-row" style="margin: 20px 0 10px">
                                            <div class="setting-cell">
                                                <label>文明名称: </label>
                                                <el-input
                                                    v-model="civilEditorResult['名称']"
                                                    style="width: 180px"
                                                ></el-input>
                                            </div>
                                        </div>
                                        <div
                                            class="setting-row"
                                            style="margin: 0 0 10px 0; height: auto; min-height: 40px; flex-wrap: wrap"
                                            v-for="index0 in 10"
                                        >
                                            <span style="font-weight: bold; margin-right: 20px">
                                                {{ civilEditorStepLabel[index0-1] }}
                                            </span>
                                            <el-tooltip
                                                v-for="(item, index) in civilEditorResult[civilEditorStepLabel[index0-1]]"
                                                :key="'civil-editor-'+item.name"
                                                popper-class="hint-popper"
                                                effect="dark"
                                                placement="bottom"
                                            >
                                                <div slot="content" class="building-hint">
                                                    <div class="building-hint-row div1">
                                                        建筑名称:
                                                        <span style="font-weight: bold">{{ item.name }}</span>
                                                    </div>
                                                    <div class="building-hint-row div2">
                                                        显示文字:
                                                        <span style="font-weight: bold">{{ item.text }}</span>
                                                    </div>
                                                    <span class="building-hint-cell div3">
                                                        宽度:
                                                        <span style="font-weight: bold">{{ item.width }}</span>
                                                        格
                                                    </span>
                                                    <span class="building-hint-cell div4">
                                                        高度:
                                                        <span style="font-weight: bold"> {{ item.height }} </span>
                                                        格
                                                    </span>
                                                    <span class="building-hint-cell div5">
                                                        文字颜色:
                                                        <span
                                                            :style="{ color: item.color, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.color }}
                                                        </span>
                                                    </span>
                                                    <span class="building-hint-cell div6">
                                                        字体大小:
                                                        <span style="font-weight: bold">16</span>
                                                        px
                                                    </span>
                                                    <span class="building-hint-cell div7">
                                                        边框颜色:
                                                        <span
                                                            :style="{ color: item.borderColor, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.borderColor }}
                                                        </span>
                                                    </span>
                                                    <span class="building-hint-cell div8">
                                                        边框宽度:
                                                        <span style="font-weight: bold">1</span>
                                                        px
                                                    </span>
                                                    <span class="building-hint-cell div9">
                                                        背景颜色:
                                                        <span
                                                            :style="{ color: item.backgroundColor, textShadow: 'var(--color-border-base) 0px 1px 10px', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.backgroundColor }}
                                                        </span>
                                                    </span>
                                                    <span class="building-hint-cell div10">
                                                        影响范围:
                                                        <span style="font-weight: bold">{{ item.range }}</span>
                                                        格
                                                    </span>
                                                    <span class="building-hint-cell div11">
                                                        美化建筑:
                                                        <span
                                                            :style="{ color: item.isDecoration ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.isDecoration ? '√' : '×' }}
                                                        </span>
                                                    </span>
                                                    <span class="building-hint-cell div12">
                                                        奇迹建筑:
                                                        <span
                                                            :style="{ color: item.isMiracle ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.isMiracle? '√' : '×' }}
                                                        </span>
                                                    </span>
                                                    <span class="building-hint-cell div13">
                                                        防护建筑:
                                                        <span
                                                            :style="{ color: item.isProtection ? 'var(--color-success)' : 'var(--color-danger)', fontWeight: 'bold' }"
                                                        >
                                                            {{ item.isProtection? '√' : '×' }}
                                                        </span>
                                                    </span>
                                                </div>
                                                <el-tag
                                                    size="medium"
                                                    style="margin: 10px; cursor: pointer"
                                                    :effect="item.effect"
                                                    @click="selectCivilTag(index, index0-1)"
                                                >
                                                    {{ (index+1) + ". " + item.name }}
                                                </el-tag>
                                            </el-tooltip>
                                        </div>
                                    </div>
                                </el-scrollbar>
                                <div id="civil-editor-setting-button">
                                    <el-button-group v-show="civilEditorActiveStep<11">
                                        <el-button
                                            type="primary"
                                            size="small"
                                            @click="updateCivilEditorStep(civilEditorActiveStep===0?0:civilEditorActiveStep-1)"
                                            icon="el-icon-arrow-left"
                                            round
                                        >
                                            上一步
                                        </el-button>
                                        <el-button
                                            type="primary"
                                            size="small"
                                            @click="updateCivilEditorStep(civilEditorActiveStep+1)"
                                            round
                                        >
                                            下一步
                                            <i class="el-icon-arrow-right"></i>
                                        </el-button>
                                    </el-button-group>
                                    <el-button-group v-show="civilEditorActiveStep>=11">
                                        <el-button
                                            type="primary"
                                            size="small"
                                            @click="updateCivilEditorStep(civilEditorActiveStep===0?0:civilEditorActiveStep-1)"
                                            icon="el-icon-arrow-left"
                                            round
                                        >
                                            上一步
                                        </el-button>
                                        <el-button type="primary" size="small" @click="generateNewCivil" round>
                                            生&ensp;成&ensp;
                                            <i class="el-icon-download"></i>
                                        </el-button>
                                    </el-button-group>
                                </div>
                            </div>
                        </el-tab-pane>
                    </el-tabs>
                </div>
            </div>
        </div>
        <div id="ghost-container">
            <div class="ghost">
                <div class="face">
                    <div class="eyes">
                        <span></span>
                        <span></span>
                    </div>
                    <div class="mouth"></div>
                </div>
                <div class="hands">
                    <span></span>
                    <span></span>
                </div>
                <div class="feet">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="ghost-text">Loading...</div>
            <div id="ghost-text-hint">若无法打开页面，请尝试使用Ctrl+F5强制刷新页面！</div>
        </div>
        <div id="loading-background-container">
            <div id="loading-background"></div>
        </div>
        <a href="" id="download" download="" style="display: none"></a>
        <input id="load-file" type="file" style="display: none" accept=".txt" />
        <script src="./library/vue.v2.6.12.js"></script>
        <script src="./library/element-ui.v2.14.1.js"></script>
        <script>
            let $config = new Config();
        </script>
        <script src="./js/vm.js"></script>
        <script src="./js/main.js"></script>
    </body>
</html>
